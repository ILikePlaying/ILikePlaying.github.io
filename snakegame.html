<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        canvas {
            border: 1px solid #000;
            margin: auto;
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const canvas = document.getElementById("gameCanvas");
            const ctx = canvas.getContext("2d");

            const WIDTH = 800;
            const HEIGHT = 600;
            const GRID_SIZE = 20;
            const FPS = 10;

            const WHITE = "#FFFFFF";
            const BLACK = "#000000";
            const GREEN = "#00FF00";

            const UP = { x: 0, y: -1 };
            const DOWN = { x: 0, y: 1 };
            const LEFT = { x: -1, y: 0 };
            const RIGHT = { x: 1, y: 0 };

            class Snake {
                constructor() {
                    this.length = 1;
                    this.positions = [{ x: WIDTH / 2, y: HEIGHT / 2 }];
                    this.direction = randomDirection();
                    this.color = GREEN;
                }

                getHeadPosition() {
                    return this.positions[0];
                }

                update() {
                    const current = this.getHeadPosition();
                    const { x, y } = this.direction;
                    const newHead = {
                        x: (current.x + x * GRID_SIZE + WIDTH) % WIDTH,
                        y: (current.y + y * GRID_SIZE + HEIGHT) % HEIGHT,
                    };

                    if (this.positions.slice(1).some(p => p.x === newHead.x && p.y === newHead.y)) {
                        this.reset();
                    } else {
                        this.positions.unshift(newHead);
                        if (this.positions.length > this.length) {
                            this.positions.pop();
                        }
                    }
                }

                reset() {
                    this.length = 1;
                    this.positions = [{ x: WIDTH / 2, y: HEIGHT / 2 }];
                    this.direction = randomDirection();
                }

                render() {
                    for (const p of this.positions) {
                        ctx.fillStyle = this.color;
                        ctx.fillRect(p.x, p.y, GRID_SIZE, GRID_SIZE);
                    }
                }
            }

            class Food {
                constructor() {
                    this.position = { x: 0, y: 0 };
                    this.color = WHITE;
                    this.randomizePosition();
                }

                randomizePosition() {
                    this.position = {
                        x: Math.floor(Math.random() * (WIDTH / GRID_SIZE)) * GRID_SIZE,
                        y: Math.floor(Math.random() * (HEIGHT / GRID_SIZE)) * GRID_SIZE,
                    };
                }

                render() {
                    ctx.fillStyle = this.color;
                    ctx.fillRect(this.position.x, this.position.y, GRID_SIZE, GRID_SIZE);
                }
            }

            const randomDirection = () => {
                const directions = [UP, DOWN, LEFT, RIGHT];
                return directions[Math.floor(Math.random() * directions.length)];
            };

            const snake = new Snake();
            const food = new Food();

            document.addEventListener("keydown", function(event) {
                switch (event.key) {
                    case "ArrowUp":
                        snake.direction = UP;
                        break;
                    case "ArrowDown":
                        snake.direction = DOWN;
                        break;
                    case "ArrowLeft":
                        snake.direction = LEFT;
                        break;
                    case "ArrowRight":
                        snake.direction = RIGHT;
                        break;
                }
            });

            function main() {
                snake.update();

                if (snake.getHeadPosition().x === food.position.x && snake.getHeadPosition().y === food.position.y) {
                    snake.length++;
                    food.randomizePosition();
                }

                ctx.fillStyle = BLACK;
                ctx.fillRect(0, 0, WIDTH, HEIGHT);
                snake.render();
                food.render();

                setTimeout(main, 1000 / FPS);
            }

            main();
        });
    </script>
</body>
</html>
